
{% extends "base.html" %}
{% block content %}
<div class="card">
  <h1>Profit & Loss Summary</h1>
  <div class="grid-3">
    <div><div class="small">Total Income</div><div style="font-size:24px; font-weight:800;">{{ income|currency }}</div></div>
    <div><div class="small">Total Expenses</div><div style="font-size:24px; font-weight:800;">{{ expense|currency }}</div></div>
    <div><div class="small">Net</div><div class="{{ 'profit' if profit >= 0 else 'loss' }}" style="font-size:24px;">{{ profit|currency }}</div></div>
  </div>
</div>
<div class="card">
  <h2>Recent Activity</h2>
  <table class="table">
    <thead><tr><th>Date</th><th>Type</th><th>Category</th><th>Truck</th><th>Driver</th><th>Description</th><th style="text-align:right;">Amount</th></tr></thead>
    <tbody>
      {% if recent|length == 0 %}<tr><td colspan="7">No data yet.</td></tr>{% endif %}
      {% for e in recent %}
      <tr>
        <td>{{ e.entry_date }}</td>
        <td><span class="badge {{ 'income' if e.is_income==1 else 'expense' }}">{{ 'Income' if e.is_income==1 else 'Expense' }}</span></td>
        <td>{{ e.category }}</td>
        <td>{{ e.truck_name or '-' }}</td>
        <td>{{ e.driver_name or '-' }}</td>
        <td>{{ e.description or '' }}</td>
        <td style="text-align:right;">
          {% if e.is_income==1 %}{{ e.amount|currency }}
          {% else %}{% if e.hst_included==1 %}{{ e.amount|currency }}{% else %}{{ (e.amount*1.13)|round(2)|currency }}{% endif %}{% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
